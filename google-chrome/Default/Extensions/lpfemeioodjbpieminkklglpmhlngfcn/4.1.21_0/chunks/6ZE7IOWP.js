import{a as E}from"./V2CDCVTT.js";import{a as u}from"./MM6H3LLZ.js";import{h as i}from"./GSRXIUGZ.js";import{a as l}from"./42TZCCKB.js";import{f as c}from"./UTGLRY7A.js";var p=c(l());var o="USECHATGPT_AUTH_INFO_STORAGE_KEY_20230829";var n={new_user:0,old_free_user:0,pro_gift:0,free:0,pro:1,elite:2};var a=c(u());var R={GET_USER_INFO:"/user/get_user_info",TWITTER_SHARE_COMPLETE:"/user/twitter_share_complete",TWITTER_FOLLOWING_COMPLETE:"/user/twitter_following_complete",GET_REFERRAL_DASHBOARD:"/user/get_referral_dashboard",SAVE_TWITTER_SCREEN_NAME:"/user/save_twitter_screen_name",GET_TWITTER_REFERRAL_TASKS_STATUS:"/user/get_twitter_referral_tasks_status",GET_USER_SUBSCRIPTION_INFO:"/user/get_user_subscription_info"},O={GET_FAVOURITE_PROMPTS:"/prompt/get_favourite_prompts",GET_OWN_PROMPTS:"/prompt/get_own_prompts",SEARCH_PROMPT:"/prompt/search_prompt",GET_PROMPT_DETAIL:"/prompt/get_prompt_detail",GET_PRIVATE_PROMPT_DETAIL:"/prompt/get_private_prompt_detail",PROMPT_CATEGORY:"/prompt/category",ADD_PROMPT:"/prompt/add_own_prompt",ADD_FAVOURITE_PROMPT:"/prompt/add_favourite_prompt",REMOVE_FAVOURITE_PROMPT:"/prompt/remove_favourite_prompt",DELETE_PROMPT:"/prompt/remove_own_prompt",EDIT_OWN_PROMPT:"/prompt/update_own_prompt"};var h=()=>{try{let e=window.localStorage.getItem("UseChatGPTAuthServiceProvider.email"),r=`UseChatGPTAuthServiceProvider.${e}`,t=window.localStorage.getItem(r+".accessToken"),s=window.localStorage.getItem(r+".refreshToken");return s?{accessToken:t,refreshToken:s,email:e}:null}catch{return null}},f=async()=>{let e=await p.default.storage.local.get(o);return e[o]?e[o]?.refreshToken:""},w=async()=>{let e=await p.default.storage.local.get(o);return e[o]?e[o]?.userInfo:null},G=async()=>(await new E({runtime:"client"}).postMessage({event:"Client_logoutUseChatGPTAuth"})).success,C=async()=>{try{let e=await f();if(!e)return;let r=await fetch(`${i}${R.GET_USER_SUBSCRIPTION_INFO}`,{headers:{Authorization:`Bearer ${e}`}});if(r.ok){let t=await r.json();if(t.status==="OK"&&t.data)return t.data}return}catch{return}},y=e=>{let t=[...e.roles].sort((_,T)=>(n[T.name]||0)-(n[_.name]||0))?.[0].name||"free",s=!1;if(e?.chatgpt_expires_at&&t==="free"&&new Date(e.chatgpt_expires_at).getTime()>new Date().getTime()&&(t="pro_gift"),t==="free"&&e?.created_at){let _=(0,a.default)(e?.created_at);(0,a.default)().utc().diff(_,"day")<=-1e5&&(t="new_user",s=!0)}return t};export{o as a,O as b,h as c,f as d,w as e,G as f,C as g,y as h};
